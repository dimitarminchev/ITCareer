## 8. Управление на състоянието в уеб приложенията

### Бисквитки

* Малък файл с обикновен текст без изпълним код
* Изпраща се от сървъра до браузъра на клиента
* Съхранява се от браузъра на устройството на клиента&#x20;
* Съхранява малка част данни за конкретен клиент и уеб сайт

#### За какво се използват бисквитки?

* **Управление на сесиите** = Вход, колички за пазаруване, резултати от игри или нещо друго, което сървърът трябва да запомни
* **Персонализация** = Потребителски предпочитания, теми и персонализирани настройки
* **Проследяване** = Записване и анализ на поведението на потребителя

#### Как се използват бисквитките?
Отговорът държи бисквитките, които трябва да бъдат запазени в Set-Cookie хедъра
```
HTTP/1.1 200 OK
Set-Cookie: lang=en
```
Заявката съдържа специфичната за даден уебсайт бисквитка в рамките на Cookie хедъра
```
GET www.example.bg HTTP/1.1
Cookie: lang=en
```

#### Структура на бисквитките
Бисквитката се състои от име, стойност и атрибути.

Атрибутите:
* Двойки ключ-стойност с допълнителна  информация
* Не са включват в заявките
*   Използват се от клиента за контрол на бисквитките
```
Set-Cookie: SSID=Ap4P…GTEq; Domain=foo.com; Path=/; Expires=Wed, 13 Jan 2021 22:23:01 GMT; Secure; HttpOnly
```
* **Обхват** = Определя се от атрибутите Domain и Path
* **Живот** = Определя се от атрибутите Expires и Max-Age
* **Сигурност** = Определя се от защитните флагове Secure и HttpOnly.

#### Разгледайте Вашите бисквитки
Местоположение на бисквитките на Mozilla
```
C:\Users\{username}\AppData\Roaming\Mozilla\Firefox\Profiles\{name}.default\cookies.sqlite
```
Местоположение на бисквитките на Chrome
```
C:\Users\{username}\AppData\Local\Google\Chrome\User Data\Default\Cookies
```

### Сесии
* Сесиите представяват начин за съхраняване на информация за потребител.
* Сесиите предоставят механизмът за обмен  между потребителя и уеб приложението.

Структура на сесия
```
"hje85d3" : 
{
    user_id: 789
    username: FirstUser
},
"af354dd" : 
{
    user_id: 456
    username: SecondUser
},
"fg78e5s" : 
{
    user_id: 654
    username: ThirdUser
}
```
